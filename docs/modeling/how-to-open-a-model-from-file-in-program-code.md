---
title: 'Nasıl yapılır: Program Kodunda Dosyadan Model Açma'
description: ModelBus 'ın bir modeldeki model veya öğelere başvurmak için standart mekanizmayı ve taşındığını varsa modeli bulmasını sağlar.
ms.custom: SEO-VS-2020
ms.date: 11/04/2016
ms.topic: how-to
author: mgoertz-msft
ms.author: mgoertz
manager: jmartens
ms.workload:
- multiple
ms.openlocfilehash: 97de2d7e79dc44ff785663c4d04dc65851430472
ms.sourcegitcommit: e3a364c014ccdada0860cc4930d428808e20d667
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 06/19/2021
ms.locfileid: "112387066"
---
# <a name="how-to-open-a-model-from-file-in-program-code"></a>Nasıl yapılır: Program Kodunda Dosyadan Model Açma

DSL modellerini herhangi bir uygulamada açabilirsiniz.

Visual Studio uzantılarından bu amaçla ModelBus kullanabilirsiniz. ModelBus bir modeldeki model veya öğelere başvurmak ve taşındıktan sonra modeli bulmak için standart bir mekanizma sağlar. Daha fazla bilgi için bkz. [Visual Studio ModelBus kullanarak modelleri tümleştirme](../modeling/integrating-models-by-using-visual-studio-modelbus.md).

## <a name="target-framework"></a>Hedef çerçeve

Uygulama projenizin **hedef çerçevesini** .NET Framework 4 veya üzeri olarak ayarlayın.

1. Bir DSL modeli okumak istediğiniz uygulama için Visual Studio projesini açın.

2. **Çözüm Gezgini**, projeye sağ tıklayın ve ardından **Özellikler**' e tıklayın.

3. Proje Özellikleri penceresinde, **uygulama** sekmesinde, **hedef Framework** alanını **.NET Framework 4** (veya üzeri) olarak ayarlayın.

> [!NOTE]
> Hedef Framework **.NET Framework 4 Istemci profili** olmamalıdır.

## <a name="references"></a>Başvurular

Bu başvuruları Visual Studio uygulama projenize ekleyin:

- `Microsoft.VisualStudio.Modeling.Sdk.11.0`

  - **Başvuru Ekle** iletişim kutusunda **.net** sekmesinde bunu görmüyorsanız, **Gözden** geçirme sekmesine tıklayın ve öğesine gidin `%Program Files%\Microsoft Visual Studio 2010 SDK\VisualStudioIntegration\Common\Assemblies\` .

- Dsl projenizin bin klasörü altında bulacağınız DSL derlemenizin olması gerekir. Genellikle kendi adı şu biçimdedir: *yourcompany*. *Yourprojem* `.Dsl.dll` .

## <a name="important-classes-in-the-dsl"></a>DSL 'deki önemli sınıflar

DSL 'yi okuyan kodu yazmadan önce, DSL 'niz tarafından oluşturulan sınıfların bazılarının adlarını bilmeniz gerekir. DSL çözümünüzde **DSL** projesini açın ve **GeneratedCode** klasörüne bakın. Alternatif olarak, proje **başvurularında** DSL derlemesine çift tıklayın ve **nesne TARAYıCıSı**' de dsl ad alanını açın.

Şunları belirlemeniz gereken sınıflardır:

- *YourDslRootClass* -bu, içindeki kök sınıfın adıdır `DslDefinition.dsl` .

- *Yourdslname* `SerializationHelper` -Bu sınıf `SerializationHelper.cs` DSL projenizde tanımlanmıştır.

- *Yourdslname* `DomainModel` -Bu sınıf `DomainModel.cs` DSL projenizde tanımlanmıştır.

## <a name="read-from-a-file"></a>Dosyadan okuma

Aşağıdaki örnek, önemli sınıfların aşağıdaki gibi olduğu bir DSL okumak için tasarlanmıştır:

- FamilyTreeModel

- FamilyTreeSerializationHelper

- FamilyTreeDomainModel

Bu DSL 'deki diğer etki alanı sınıfı kişidir.

```csharp
using System;
using Microsoft.VisualStudio.Modeling;
using Company.FamilyTree; // Your DSL namespace

namespace StandaloneReadDslConsole
{ class Program
  { static void Main(string[] args)
    {
      // The path of a DSL model file:
      string dslModel = @"C:\FamilyTrees\Tudor.ftree";
      // Set up the Store to read your type of model:
      Store store = new Store(
        typeof(Company.FamilyTree.FamilyTreeDomainModel));
      // The Model type generated by the DSL:
      FamilyTreeModel familyTree;
      // All Store changes must be in a Transaction:
      using (Transaction t =
        store.TransactionManager.BeginTransaction("Load model"))
      {
        familyTree =
           FamilyTreeSerializationHelper.Instance.
              LoadModel(store, dslModel, null, null, null);
        t.Commit(); // Don't forget this!
      }
      // Now we can read the model:
      foreach (Person p in familyTree.People)
      {
        Console.WriteLine(p.Name);
        foreach (Person child in p.Children)
        {
          Console.WriteLine("    " + child.Name);
        }
} } } }
```

## <a name="save-to-a-file"></a>Bir dosyaya kaydet

Önceki koda eklenen aşağıdaki ekleme modelde değişiklik yapar ve bir dosyaya kaydeder.

```csharp
using (Transaction t =
  store.TransactionManager.BeginTransaction("update model"))
{
  // Create a new model element:
  Person p = new Person(store);
  // Set its embedding relationship:
  p.FamilyTreeModel = familyTree;
  // - same as: familyTree.People.Add(p);
  // Set its properties:
  p.Name = "Edward VI";
  t.Commit(); // Don't forget this!
}
// Save the model:
try
{
  SerializationResult result = new SerializationResult();
  FamilyTreeSerializationHelper.Instance
    .SaveModel(result, familyTree, @"C:\FamilyTrees\Tudor-upd.ftree");
  // Report any error:
  if (result.Failed)
  {
    foreach (SerializationMessage message in result)
    {
      Console.WriteLine(message);
    }
  }
}
catch (System.IO.IOException ex)
{ ... }
```
